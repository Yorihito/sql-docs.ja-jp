---
title: データマイニングサーバーに接続する |Microsoft Docs
ms.custom: ''
ms.date: 12/29/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- connections
- getting started
ms.assetid: 85962ad6-d840-4bc6-905e-c667c3276944
author: minewiskan
ms.author: owend
ms.openlocfilehash: 6e7fca367c72aaff5f02280829740942a36915ff
ms.sourcegitcommit: 2f166e139f637d6edfb5731510d632a13205eb25
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/08/2020
ms.locfileid: "84527238"
---
# <a name="connect-to-a-data-mining-server"></a>データ マイニング サーバーへの接続
  ![[接続] ボタン](media/misc-connection.gif "[接続] ボタン")  
  
 [**接続**] ボタンをクリックして既存の接続を選択するか、のインスタンスへの新しい接続を作成し [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] ます。  
  
 **サーバーへの接続が必要な理由**  
  
 接続を作成すると、[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] サーバーが提供するデータ マイニング アルゴリズムと、サーバーによる最適化された処理を利用できます。  
  
 データまたは結果を [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] データベースまたは SQL Server データベースに保存する必要はありません。 Excel データ マイニング アドインでは、Excel だけに格納されているデータまたは Excel データ ソースとして接続するデータを操作できます。  
  
## <a name="how-to-create-a-new-connection"></a>新しい接続を作成する方法  
  
1.  [**接続**] ボタンをクリックします。  
  
2.  [ **Analysis Services 接続**] ダイアログボックスで、[**新規**] をクリックします。  
  
3.  [ **Analysis Services への接続**] ダイアログボックスで、サーバー名を入力します。  
  
4.  認証方法を指定します。  
  
5.  データ マイニング モデルを格納するカタログまたは [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] データベースを指定します。  
  
    > [!NOTE]  
    >  データベースをまだ作成していない場合は、(既定値) を使用して接続を作成し、テストできます。ただし、マイニング モデルを既定の接続に追加することはできません。 マイニング モデルを作成する前に、既存のデータベースへの接続を作成する必要があります。  
  
6.  Web サービス経由でサーバーに接続する場合は、Web サービスから要求されるユーザー名およびパスワードを入力します。  
  
7.  新しい接続の表示名を入力します。  
  
8.  [**接続テスト**] をクリックして、サーバーが使用可能であることを確認します。  
  
## <a name="troubleshooting-connections"></a>接続のトラブルシューティング  
 このセクションでは、[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] への接続に関する一般的な質問の回答を提供します。  
  
 **"接続が見つかりませんでした" というメッセージが表示できます。**  
  
 ボタンの下部のテキストが [**接続なし**] と表示されている場合は、データベースへの接続が作成されていないか、接続に失敗したことを意味 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] します。 Access など他のソースからの Excel 内のデータの作業は継続できますが、データ マイニング モデルの作成や予測クエリの実行のためにはアクティブな接続が必要です。  
  
 **サーバーを使用するためのアクセス許可がないとします。**  
  
 サーバーにマイニングモデルを格納するための十分なアクセス許可がない場合、またはデータマイニングを使用して作業を保存しない場合は、一時的なデータ構造と一時的なモデルを作成するテーブル分析ツールを使用できます。 その場合でも、サーバーに一時的なモデルを格納できる権限が必要です。 サーバーで*セッションマイニングモデル*の使用を有効にするには、管理者に依頼してください。  
  
 モデルが保存されていることを確認する場合は、一時的なモデルを使用するオプションを無効にするか、データ マイニング クライアント内のウィザードを使用することができます。 これらのウィザードには、サーバーのすべてのモデルが格納されています。 モデルが格納されているデータベースへの管理アクセス権が必要です。そのため、管理者は、特にアドインを使用してマイニングモデルを作成するためのデータベースを作成することをお勧めします。  
  
 **接続が失われた場合は、すべての作業内容も失われていますか?**  
  
 サーバーへの接続を終了しても結果とデータが失われることはありません。これは、これらが Excel に保存されているためです。 ただし一時的なモデルを作成している場合、これらのモデルはすぐにサーバーから削除されます。 そのため、一時的に接続が切断されても、モデルがまだ削除されない場合があります。  
  
 すべてのレポートおよびテーブルが Excel 内に保存されるため、生成した結果やデータが失われることはありません。  
  
> [!NOTE]  
>  アドインが [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] サーバーとやり取りしている間は、サーバーまたはネットワークから接続解除しないでください。 たとえば、モデルの作成中やデータの処理中には接続解除しないでください。 状況によっては、データが破損する場合があります。  
  
 **Visio のツールを使用してモデルに接続できません**  
  
 Visio 用のデータ マイニング テンプレートでは、一時的なマイニング構造およびモデルを使用できません。 マイニング モデルのダイアグラムを作成するには、そのモデルがサーバー上に格納されている必要があります。  
  
 **接続の使用状況を監視する方法は?**  
  
 [Excel&#41;用のトレース &#40;データマイニングクライアント](trace-data-mining-client-for-excel.md)は、アドインと指定されたサーバー間のすべてのアクティビティのログを作成します。  
  
 セッションモデルの監視を有効にするには、[**トレーサー** ] ダイアログボックスの [**セッションモデルを使用**する] オプションを選択します。  
  
 トレースでは、モデルと構造を作成する際に生成された DMX および XMLA コマンドを表示できます。 また、結果とその他のレポートを Excel で生成するためにクライアントが送信したクエリも表示できます。  
  
 **一時的なモデルとは一時的なモデルを保存するにはどうすればよいですか。**  
  
 Excel 用テーブル分析ツールは、既定で一時的なデータ構造とマイニング モデルを作成します。 ブックを開いた状態で [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] への接続を保持している限り、一時的なモデルの参照やクエリを継続して実行できます。  
  
 Excel ブックを閉じるか [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] への接続を変更または終了すると、構造とモデルが直ちに削除されます。  
  
 Excel 用データ マイニング クライアントのウィザードを完了する際は、既定でモデルがサーバーに保存されます。ただし、各ウィザードの最終ページには、一時的なモデルを使用するためのオプションがあります。 このオプションを選択した場合は、作成したデータ マイニング構造とモデルが一時ファイルに格納されます。 Excel を開いている限り、構造およびモデルを参照、管理、および変更できます。 ただし、Excel を終了すると、構造とすべての関連モデルが削除されます。  
  
 また、**データマイニング詳細クエリエディター**を使用し、DMX テンプレートの1つを選択して、一時的な構造またはモデルを明示的に作成することもできます。 `USE SESSION MODELS` 句を追加すると、これらのオブジェクトが一時的なものとして指定されます。   
  
### <a name="creating-backups-of-mining-models-and-structures"></a>マイニング モデルおよび構造のバックアップの作成  
 モデルまたは構造のバックアップを作成するには、Excel 用のデータマイニングクライアントで、[[モデルの管理 &#40;SQL Server データマイニングアドイン&#41;](manage-models-sql-server-data-mining-add-ins.md)を使用してエクスポートします。  
  
 通常、作成された一時的なマイニング モデルには、Table5_593679_TS_62446 などのわかりにくい名前が付いています。 ただし、[ [Excel&#41;用のトレース &#40;データマイニングクライアント](trace-data-mining-client-for-excel.md)] ツールを使用すると、テーブル分析ツールによって作成された一時的な構造およびモデルの名前を検出し、[**モデルの管理**] を使用してそれらをバックアップできます。  
  
##### <a name="identify-and-export-a-temporary-model"></a>一時的なモデルの特定とエクスポート  
  
1.  Excel 用のデータマイニングクライアントの [**接続**] グループで、[**トレース**] をクリックします。  
  
2.  接続のアクティビティ ログを表示して、列および予測可能な出力 (一例です) を確認してモデルを特定します。  
  
     上級ユーザー: DMX または XMLA について理解している場合は、ステートメントをファイルにコピーして後で使用することができます。  
  
3.  一時的なモデルと構造の名前が見つかったら、[モデルの**管理**] を開き、モデルを選択します。  
  
4.  [このマイニング モデルをエクスポートします] をクリックして、指定した場所にスクリプト ファイルを生成します。  
  
## <a name="see-also"></a>参照  
 [Excel 用のデータマイニングクライアント &#40;ソースデータへの接続&#41;](connect-to-source-data-data-mining-client-for-excel.md)   
 [Excel 用データマイニングアドイン &#40;サーバー構成ユーティリティ&#41;](server-configuration-utility-data-mining-add-ins-for-excel.md)  
  
  
