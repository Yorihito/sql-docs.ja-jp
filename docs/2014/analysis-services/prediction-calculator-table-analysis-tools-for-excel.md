---
title: 予測計算 (Excel 用のテーブル分析ツール) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- mining model, regression
- Table Analysis tools
- scorecard
- logistic regression
- prediction calculator
ms.assetid: 8bb8c318-e85f-4fd6-b32b-4cdfb13ca1b5
author: minewiskan
ms.author: owend
ms.openlocfilehash: fa763516511f3d2fd68ca5275cdeb6fe0af7d57b
ms.sourcegitcommit: f0772f614482e0b3cde3609e178689ce62ca3a19
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/09/2020
ms.locfileid: "84547674"
---
# <a name="prediction-calculator-table-analysis-tools-for-excel"></a>予測計算 (Excel 用のテーブル分析ツール)
  ![予測計算ツール](media/tat-predcal.gif "予測計算ツール")  
  
 **予測計算**ツールを使用すると、新しいデータを分析してオプションやリスクを評価する際に使用できるスコアカードを作成できます。 たとえば、顧客に関する履歴データと人口統計データがある場合、**予測計算**ツールを使用すると、次の2つの主要な作業を行うことができます。  
  
-   人口統計や購買行動など、さまざまな要因についての基礎となる分析の生成。  
  
-   メンバーを評価して新しい製品やサービスを提案する場合に役立つ作業スコアカードの作成。  
  
 ウィザードでは、基になるすべての計算が格納されたワークシートも作成されます。これにより、モデルを操作して、さまざまな入力値が最終的なスコアに与える影響を調べることができます。  
  
 また、必要に応じて、ワークシートの印刷バージョンを作成してオフラインでスコアリングを行うこともできます。 印刷バージョンは、オンラインの Excel ブックのようにモデルを操作することはできません。ただし印刷バージョンのワークシートには、値を記入して最終的なスコアを計算するためのすべての計算が含まれています。  
  
## <a name="using-the-prediction-calculator-tool"></a>予測計算ツールの使用  
  
1.  分析するデータが含まれている Excel テーブルを開きます。  
  
2.  [**分析**] タブの [**予測計算**] をクリックします。  
  
3.  [**予測計算**] ダイアログボックスの [ターゲット] で、購入行動など、予測する列を選択します。  
  
4.  ターゲット値を指定します。 値が数値の場合は、[**範囲] で**オプションを使用して、目的の範囲の最小値と最大値を入力します。 値が不連続の場合は、[**正確**] オプションを選択し、ドロップダウンリストから値を選択します。  
  
5.  [**分析に使用する列の選択**] をクリックします。  
  
6.  **[高度な列の選択**] ダイアログボックスで、有用な情報が含まれている列を選択します。 分析に関係のない列は削除してください。 **[OK]** をクリックします。  
  
     結果がゆがめられるのを避けるためには、重複する情報を含む列も削除する必要があります。 たとえば、数値データを含む収入の列と、"高"、"中"、"低" というラベルを含む収入グループの列がある場合は、両方の列を同じモデルに含めないようにしてください。 代わりに、それぞれの列に対して別のモデルを作成します。  
  
7.  [**出力オプション**] セクションで、[**オペレーション計算ツール**] を選択して、Excel ブック内に分析とスコアカードを作成します。 [印刷**準備完了の計算**] を選択すると、分析が作成されます。また、レポートを生成して、手動でスコアリングするために印刷して使用することもできます。  
  
8.  **[実行]** をクリックします。  
  
     レポートやスコアカードを含む新しいワークシートが作成されます。  
  
### <a name="requirements"></a>要件  
 **予測計算**ツールでは、Microsoft ロジスティック回帰アルゴリズムが使用されます。このアルゴリズムでは、不連続な値と、分離された連続する数値データを操作できます。  
  
## <a name="understanding-the-scoring-reports"></a>スコアリング レポートについて  
 両方の出力オプションを選択した場合は、現在のブックに次の 3 つの新しいワークシートが作成されます。  
  
-   分析の結果を含む**予測レポート**。対話型のテーブルとグラフを使用して、相互作用や利益を試すことができます。  
  
-   スコアの作成に役立つ対話型**予測計算**。  
  
-   スコア付けに使用する命令と係数を含む、**印刷可能な計算**。  
  
-   ここでは、各レポートに含まれる情報と、さまざまなレポート オプションの使用方法について説明します。  
  
### <a name="prediction-report-with-graphs"></a>グラフを含む予測レポート  
 最初の予測レポートのタイトルは **、 \<target state> の \<target attribute> の予測計算レポート**です。 このレポートには、分析から得られた要因のテーブルと、特定の分析の財務的影響を評価するためのツールが含まれています。  
  
#### <a name="table-for-specifying-costs-and-profits"></a>コストと利益を指定するためのテーブル  
 このレポートの左上にある最初のツールは、値の正確な予測や不正確な予測に関連するコストと利益を指定できるテーブルです。  これらのコストと利益は、計算の最適なスコアしきい値を算出するために必要です。  
  
|Item|説明と例|  
|----------|-----------------------------|  
|偽陽性のコスト|モデルで予測された陽性の結果が実際には間違っているのに正しいと想定した場合のコスト。<br /><br /> たとえば、顧客が商品を購入するというモデルの予測に基づいて、その顧客を対象とするキャンペーンを企画した場合の、 顧客獲得に要するコストをここに入力します。|  
|偽陰性のコスト|モデルで予測された陰性の結果が実際には間違っているのに正しいと想定した場合のコスト。<br /><br /> たとえば、年齢層の高い顧客は自転車を購入しないとモデルで予測されたが、モデルがゆがめられていたために、結果として年齢層の高い顧客を対象とする機会を逃すことになった場合の 顧客あたりのコストをここに入力します。|  
|真陽性の利益|陽性の結果が正しく予測された場合の利益です。 たとえば、適切な顧客を対象にして売上に結び付いた場合に得られる顧客あたりの利益をここに入力します。|  
|真陰性の利益|陰性の結果が正しく予測された場合の利益です。<br /><br /> たとえば、対象にしない顧客を正しく特定できた場合に節約できる顧客あたりの広告費をここに入力します。|  
  
#### <a name="chart-for-viewing-maximum-profit"></a>最大の利益を表示するためのグラフ  
 テーブルに値を入力すると、関連するグラフが自動的に更新されて、現在のモデルで利益を最大化するための最適なポイントが示されます。 このテーブルの右側にある折れ線グラフには、さまざまなスコアしきい値の利益が表示されます。 この利益は、テーブルに入力した利益とコストの数値を使用し、モデルの予測と確率に基づいて評価されます。  
  
 たとえば、左上のテーブルで、**利益を最大化するために推奨**されるしきい値のセルが500の値を示している場合、右側のグラフは、折れ線グラフの最上位ポイントとして500を示します。 この 500 という値は、マイニング モデルの上位 500 の推奨値 (確率の高い順) を使用すると利益が最大になることを表しています。  
  
#### <a name="table-listing-scores-for-each-attribute-and-value"></a>属性と値の各組み合わせのスコアを含むテーブル  
 レポートの左下にあるテーブルには、検出された値の詳細な内訳と、それぞれの値が結果に与える影響が表示されます。 このテーブルの値は変更できません。これらの値は、予測を理解しやすくするために表示されています。  
  
 たとえば次の表は、対象となる結果が顧客による自転車の購入である場合の結果の例を示しています。 このテーブルには、モデルで使用された各入力列が、モデルに影響を与えたかどうかに関係なく含まれています。 また、入力列に連続する数値データが格納されている場合は、不連続値や離散値も含まれます。  
  
 **相対的影響**列の値は、パーセンテージで表される確率です。 この値が結果に与える影響を視覚的に表すために、セルが網掛けされます。  
  
|属性|値|相対的影響|  
|---------------|-----------|---------------------|  
|Marital Status|Married|0|  
|Marital Status|Single|71|  
|性別|Female|13|  
|性別|Male|0|  
  
 これらの要因は次のように解釈できます。  
  
-   顧客が結婚していることは、その顧客が自転車を購入する可能性に影響しない。  
  
-   顧客が独身であることは、その顧客が自転車を購入する可能性が高いことを示す強力な要因となる (70%)。  
  
-   顧客の性別が自転車の購買行動の予測に与える影響は、顧客が女性の場合にはごくわずかで (13%)、顧客が男性の場合にはまったくない。  
  
#### <a name="chart-of-cumulative-misclassification-cost"></a>累積誤分類コストのグラフ  
 レポートの右下の面グラフは、さまざまなスコアしきい値の累積誤分類コストを示しています。 このグラフでも、偽陽性、真陽性、偽陰性、真陰性に対して入力するコストと利益の数値が使用されます。  
  
 利益の最大化を焦点とするレポートの右上のグラフとは違って、このグラフには、間違った予測が行われた場合のコストが組み込まれます。 正しい予測が行われた場合の利益より間違った決断が下された場合のコストの方がはるかに重視される、回避策などのシナリオで特に役に立ちます。  
  
 たとえば最初のグラフでは、モデルによって予測された上位 500 の顧客を対象にすることが利益を最大化する方法として示されていますが、この 2 つ目のグラフから、間違った顧客を対象にした場合のコストが大きすぎると判断し、最初の 400 の顧客まででマーケティング キャンペーンを打ち切ることを決断する場合も考えられます。  
  
### <a name="interactive-prediction-calculator"></a>対話型の予測計算  
 予測計算ツールによって作成された2番目のワークシートには **、 \<target state> \<target attribute> のの予測計算**というタイトルが付いています。 これは、個々のスコアを計算するために使用できる対話型ワークシートです。 このワークシートでは、モデルに格納されているパターンと統計が使用されるため、さまざまな値がスコアの予測にどのように影響するのかを試してみることができます。 またこのレポートには、対話型と参照用の 2 つのセクションが用意されています。  
  
#### <a name="first-table"></a>最初のテーブル  
 テーブルの [**値**] 列で新しい値を選択または入力すると、値の変更によってスコアにどのような影響があるかを確認できます。  
  
 たとえば、レポートに次の値が含まれていた場合、自動車の値を 1 に減らし、その後さらに 0 に減らして、顧客の購買行動にどのように影響するのかを調べることができます。 **車両**の値を0に変更すると、下の予測が TRUE に変わります。  
  
|属性|値|相対的影響|  
|---------------|-----------|---------------------|  
|Marital Status|Married|0|  
|性別|Male|0|  
|Income|39050 ~ 71062|117|  
|Children|0|157|  
|Education|Bachelors|22|  
|Occupation|Skilled Manual|33|  
|Home Owner|はい|8|  
|Cars|2|50|  
|Commute Distance|0-1 Miles|99|  
|リージョン|北米|0|  
|Age|37 ~ 46|5|  
|合計||491|  
|Prediction for 'Yes'||false|  
  
 新しい値を入力すると、セルに表示されるスコア、[はい] の予測、TRUE に変更され、さまざまな属性の**相対的な影響**スコアも更新されます。  
  
> [!NOTE]  
>  1 つの値 (車の数など) のみを変更した場合でも、他の属性の値や影響が変わることもあります。 データ マイニング モデルではデータの間に複雑な関係が検出されることが多く、1 つの変数の変更が予期しない影響をもたらすこともあるからです。 このため、対話型の予測計算を使用してさまざまな値を試してみたり、マイニング モデルを参照してその詳細を調べてみたりすることをお勧めします。 詳細については、「[モデルの参照](prediction-calculator-table-analysis-tools-for-excel.md)」を参照してください。  
  
#### <a name="score-breakdown"></a>スコアの内訳  
 このテーブルには、入力列の各状態の個々のスコアと、そのスコアが結果に与える相対的影響が示されています。 これは、参照専用の静的なテーブルです。  
  
### <a name="printable-prediction-calculator"></a>印刷可能な予測計算  
 予測計算ツールによって作成された3番目のワークシートは **、 \<target state> の \<target attribute> に対して "Printableprediction 電卓**" というタイトルが付いています。 このスコアカードは、コンピューターを使用できない場所でスコアを手動で計算できるように印刷するためのものです。  
  
##### <a name="to-print-and-use-the-scoring-report-generated-by-the-prediction-calculator"></a>予測計算によって生成されるスコアリング レポートを印刷して使用するには  
  
1.  [**印刷可能予測計算 \<attribute> **] というタイトルのタブをクリックします。  
  
2.  Excel の [ファイル] メニューの [**印刷プレビュー**] をクリックします。  
  
3.  スコアカードが目的どおりに印刷されるように、ページの向きや余白などの印刷オプションを変更します。  
  
     このスコアカードは動的なものではなく、モデルには一切関連付けられていません。したがって、書式を整えるために列や行を移動しても、基になるデータには影響しません。  
  
4.  スコアカードを印刷します。  
  
5.  各属性について値を 1 つだけ選択します。 選択した値について、ボックスにチェックマークを付け、対応する数値を [**スコア**] 列に入力します。  
  
6.  正確さを確保するため、できるだけ多くの属性のスコアを記入します。  
  
7.  各属性のスコアの合計を計算し、その数値を [**合計**] 行に入力します。  
  
8.  シートの**合計**行の直後に印刷された条件を使用して、スコアを予測結果に変換します。  
  
## <a name="related-tools"></a>関連ツール  
 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] には、この種類の分析に使用できる Microsoft ロジスティック回帰アルゴリズムが用意されています。 ロジスティック回帰について既によく理解している場合は、Excel 用のデータマイニングクライアントの **[詳細設定**] オプションを使用して、ロジスティック回帰モデルを簡単に作成できます。 詳細については、「 [Excel&#41;用の高度なモデリング &#40;データマイニングアドイン](advanced-modeling-data-mining-add-ins-for-excel.md)」を参照してください。 ロジスティック回帰モデルのオプションとパラメーターの詳細については、オンラインブックの「Microsoft ロジスティック回帰アルゴリズム」を参照してください [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] 。  
  
## <a name="see-also"></a>参照  
 [Excel 用テーブル分析ツール](table-analysis-tools-for-excel.md)  
  
  
