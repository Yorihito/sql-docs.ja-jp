---
title: 構造へのモデルの追加 (Excel 用データマイニングアドイン) |Microsoft Docs
ms.custom: ''
ms.date: 12/29/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- mining models, creating
ms.assetid: 8efd5bf4-4e6a-4ee8-971a-6efaed5f3b76
author: minewiskan
ms.author: owend
ms.openlocfilehash: 606d453235529fbfed4dc0f07178ce2ae7132067
ms.sourcegitcommit: 2f166e139f637d6edfb5731510d632a13205eb25
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/08/2020
ms.locfileid: "84528258"
---
# <a name="add-model-to-structure-data-mining-add-ins-for-excel"></a>構造へのモデルの追加 (Excel 用データ マイニング アドイン)
  ![[構造へのモデルの追加] ボタン](media/dmc-addmodel.gif "[構造へのモデルの追加] ボタン")  
  
 [**構造へのモデルの追加**] をクリックすると、既存のマイニング構造で使用する新しいマイニングモデルの作成に役立つウィザードが開始されます。 このオプションは、同じデータに基づくモデルを比較したり、カスタマイズしたモデルを作成したりできるため便利です。  
  
 Analysis Services のインスタンスに必要なデータがまだ含まれていない場合は、マイニング構造の[作成 &#40;SQL Server データマイニングアドイン&#41;](create-mining-structure-sql-server-data-mining-add-ins.md)ウィザードを使用して、マイニング構造を設定します。 または、モデリング ウィザードのいずれかを起動してから、ウィザードで作成した構造に新しいモデルを追加することもできます。  
  
 ウィザードでサポートされていないアルゴリズムを使用して高度なモデルを作成するには、マイニング構造を作成してから、**データマイニング詳細クエリエディター**を使用してモデルを追加します。  
  
## <a name="add-a-new-model-to-an-existing-structure"></a>既存の構造に新しいモデルを追加する  
  
1.  [**データマイニング**] リボンで、[**詳細設定**] の下の矢印をクリックし、[**構造へのモデルの追加**] を選択します。  
  
2.  [**構造の選択**] ダイアログボックスで、使用するデータが含まれている構造を選択し、[**次へ**] をクリックします。  
  
     **ヒント**: 必要なデータが含まれているマイニング構造がわからない場合は、**モデルのドキュメント**化ウィザードを使用して、データに関する列と基本的な統計情報を表示します。  
  
     マイニング構造が見つからない場合は、現在使用している接続を確認してください。 別のサーバーへの接続を開く必要がある場合もあります。  
  
3.  **[マイニングアルゴリズムの選択**] ダイアログボックスで、新しいマイニングモデルで使用するマイニングアルゴリズムを選択します。  
  
     このダイアログボックスには、ウィザードに表示されるよりも多くのオプションが用意されています。 データに互換性がある場合は、[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] サーバーでサポートされているアルゴリズムを使用してモデルを作成できます。  
  
4.  また、[**パラメーター** ] ボタンをクリックして [**アルゴリズムパラメーター** ] ダイアログボックスを開き、アルゴリズムのパラメーターをカスタマイズすることをお勧めします。 このオプションは、カスタム マイニング モデルを作成する最も簡単な方法です。  
  
5.  **[次へ]** をクリックします。  
  
6.  **[列の選択**] ダイアログボックスで、列の一覧を確認し、必要に応じて、列の使用法を次のいずれかの値に変更します。  
  
    -   **入力**。 列に含まれる変数が結果に影響する可能性があり、モデルへの入力として使用されます。  
  
    -   **入力と予測**。 データは入力として使用され、これらの値が予測されます。  
  
    -   **予測のみ**。 データはモデルの入力として使用されません。  
  
    -   **キー**。 各モデルには、少なくとも1つのキーが必要です。 モデルの種類によっては、 **sequencekey**や**timekey**などの追加の特殊キーを使用することもできます。  
  
    -   **使用しないで**ください。 データが構造内に存在してもモデルには使用されません。  
  
7.  参照ボタン ([. **..])** をクリックして、[**列モデルフラグの設定**] ダイアログボックスを開きます。  
  
     各データ列の使用法がモデルに適切かどうかを確認します。 これは、モデルを処理するときに発生するエラーを回避するための重要な手順です。  
  
     たとえば、デシジョン ツリー モデルに対して作成された構造を再利用して、Naïve Bayes アルゴリズムをこれに適用する場合、データ型が `Numeric` でコンテンツの種類が `Continuous` の列はビン分割するか、離散変数に変更する必要があります。  
  
     構造内の列が新しいアルゴリズムに適用されない場合は、[**使用しない**] を選択するとバイパスできます。  
  
8.  [**列モデルフラグの設定**] ダイアログボックスで、モデリングフラグ (存在する場合) を確認または設定します。  
  
     モデリング フラグを使用すると、特に null 値の処理方法を制御できます。 詳細については、「[モデリング フラグ &#40;データ マイニング&#41;](data-mining/modeling-flags-data-mining.md)」を参照してください。  
  
     完了したら [ **OK** ] をクリックして、ダイアログボックスを閉じます。  
  
9. [**完了**] ダイアログボックスで、新しいマイニングモデルの名前と説明を入力します。  
  
     作成したモデルの種類に応じて、次のオプションも表示される場合があります。  
  
    -   作成後に完成したマイニング モデルを参照します。  
  
    -   モデルからソース データへのドリルスルーを使用します。  
  
         詳細については、「[マイニングモデルのドリルスルー](data-mining/drillthrough-on-mining-models.md)」を参照してください。  
  
10. **[完了]** をクリックして、変更を保存します。 これにより、新しいモデルはサーバーに配置され処理されます。  
  
### <a name="related-options"></a>関連オプション  
  
|オプション|コメント|  
|------------|--------------|  
|**[構造またはモデルの選択**] ダイアログボックス|新しいモデルの作成の基礎として使用する既存のマイニング構造を選択します。  選択する構造は、現在の接続にある必要があります。 接続されていない場合は、[ [Excel 用データマイニングクライアント &#40;データマイニングクライアント]&#41;](connect-to-source-data-data-mining-client-for-excel.md)ツールを使用して接続を変更します。|  
|**[マイニングアルゴリズムの選択**] ダイアログボックス|接続先のサーバーに応じて、データ マイニング アルゴリズムの一覧は異なります。 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] の Standard Edition と Enterprise Edition には異なるアルゴリズムが用意されています。 管理者が、カスタム アルゴリズムを追加している場合もあります。<br /><br /> アルゴリズムが表示されない場合は、のインスタンスに接続していることを確認し [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] ます。|  
|**アルゴリズムパラメーター**ダイアログボックス|これらの設定では、分析メソッドに固有のパラメーターを使用して各アルゴリズムをカスタマイズできます。 また、モデルの結果を複数のトレーニング パス間で再現できるようにシードを設定することもできます。<br /><br /> 詳細については、「 [SQL Server データマイニングアドイン&#41;&#40;のアルゴリズムパラメーター ](algorithm-parameters-sql-server-data-mining-add-ins.md)」を参照してください。|  
|**列モデルフラグの設定**ダイアログボックス|モデリング フラグを使用すると、欠落しているデータの処理方法を指定してモデルを改善できます。 詳細については、「[モデリング フラグ &#40;データ マイニング&#41;](data-mining/modeling-flags-data-mining.md)」を参照してください。|  
  
###  <a name="setting-column-usage"></a><a name="Bkmk_mdlcolumn"></a>列の使用法の設定  
 新しいモデルを既存のマイニング構造に追加する場合は、マイニング構造の各データ列をどのようにモデルで使用するかを指定する必要があります。 このウィザードのオプションは、マイニング構造のオプションよりもはるかに詳細であることがわかります。 なぜでしょうか。  
  
 これは、ウィザードを使用してモデルと構造を一緒に作成すると、アルゴリズムでデータが使用される方法を制御する多くのオプションが自動的に設定されるためです。 ただし、既存のモデルに新しいモデルを追加する場合は、これらのオプションを手動で確認し、データを分析に使用するかどうか、データ型が正しいかどうかなどを指定する必要があります。  
  
 新しいアルゴリズムを既存のデータに適用すると、エラー メッセージが表示されることがありますが、これらは一般的に、モデルを処理するために必要な修正に関する詳細情報を提供するメッセージです。 一般的な問題を次に示します。  
  
-   モデルがその構造に含まれているデータ型とは異なるデータ型を必要としている。  
  
     アルゴリズムには、数字のみを使用できるものや、テキストのみを使用できるものがあります。 データが新しいモデルに対して無効な型である場合、モデルで処理できるように構造を変更する必要があります。  
  
-   マイニング構造に予測可能な属性が含まれていない。  
  
     クラスター モデルは予測可能な値を指定せずに作成できますが、その他のモデルは通常、予測に使用する単一列を指定する必要があります。  
  
-   データの構成は、選択したアルゴリズムと互換性がありません。  
  
     分析の種類によっては、一意の規則に従って慎重に構造化されたデータが必要です。 例として、予測モデル、アソシエーション モデルなどがあります。 たとえば、カスタマイズを行って同じ種類の新しいモデルを簡単に追加できますが、データが他のアルゴリズムでは動作しない場合があります。  
  
### <a name="requirements"></a>要件  
 データ マイニング モデルを作成するには、[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] のインスタンスに接続する必要があります。 接続を作成または変更する方法の詳細については、「 [Connect To Source data &#40;Excel 用データマイニングクライアント&#41;](connect-to-source-data-data-mining-client-for-excel.md)」を参照してください。  
  
 必要なデータ マイニング構造が表示されない場合、その構造が別のインスタンスまたは別の [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] データベースに保存されている可能性があります。 別のデータマイニング接続に変更する方法の詳細については、「[データマイニングサーバーへの接続](connect-to-a-data-mining-server.md)」を参照してください。  
  
## <a name="see-also"></a>参照  
 [データ マイニング モデルの作成](creating-a-data-mining-model.md)   
