---
title: 関連付けウィザード (Excel 用のデータマイニングクライアント) |Microsoft Docs
ms.custom: ''
ms.date: 12/29/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- nested tables, in association models
- association [data mining]
ms.assetid: 4db6462f-93c7-443f-8ff7-39474dc7029e
author: minewiskan
ms.author: owend
ms.openlocfilehash: 52542ac1b15b59ecebca4ea26ba530298157ed50
ms.sourcegitcommit: 2f166e139f637d6edfb5731510d632a13205eb25
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/08/2020
ms.locfileid: "84527944"
---
# <a name="associate-wizard-data-mining-client-for-excel"></a>アソシエーション ウィザード (Excel 用データ マイニング クライアント)
  ![[データ マイニング] リボンの関連付けウィザード](media/dmc-associate.gif "[データ マイニング] リボンの関連付けウィザード")  
  
 関連付けウィザードでは、[!INCLUDE[msCoName](../includes/msconame-md.md)] アソシエーション ルール アルゴリズムを使用してデータ マイニング モデルを作成できます。 このようなマイニングモデルは、*推奨システム*を作成する場合に特に便利です。  
  
 そのしくみは、[!INCLUDE[msCoName](../includes/msconame-md.md)] アソシエーション ルール アルゴリズムで、トランザクションまたはイベントで構成されるデータセットをスキャンし、同時に出現する頻度の高い組み合わせを探します。 数千の組み合わせがあり得ますが、アルゴリズムをカスタマイズして探す組み合わせの数を増減して、可能性の高い組み合わせだけを保持することができます。  
  
 アソシエーション分析は多くの問題に適用できます。 この方法の最も一般的な適用例は、同時に購入されることの多い製品を見つけるマーケット バスケット分析です。 その情報を使用すると、顧客が既に購入したアイテムに基づいて、顧客に製品を推奨できます。  
  
## <a name="using-the-associate-wizard"></a>関連付けウィザードの使用  
  
1.  [**データマイニング**] リボンで、[**関連付け**] をクリックします。  
  
2.  [**ソースデータの選択**] ページで、Excel テーブルまたはデータ範囲を選択し、[**次へ**] をクリックします。  
  
     サンプル データ ブックの [関連付け] タブには、各トランザクションに複数の製品がある場合や分析する顧客ごとに複数の購入レコードがある場合などに、トランザクション データが通常どのように配置されるかを示す例が含まれています。  
  
     関連付けウィザードを使用して外部データを使用してアソシエーションモデルを作成する場合は、最初にデータを Excel に追加し、データを*フラット*化する必要があります。 アソシエーションモデリング用のデータの準備の詳細については、SQL Server オンラインブックの「[入れ子になったテーブル &#40;Analysis Services データマイニング&#41;](data-mining/nested-tables-analysis-services-data-mining.md)」を参照してください。  
  
3.  [**関連付け**] ページで、トランザクションを識別する列を選択します。  
  
     マーケット バスケット モデルの場合、この識別子は、モデル化する単位を表します。 個々の顧客が一定期間内に購入したアイテムを分析する場合や、複数の顧客に関連する多くのトランザクションを分析する場合があります。 前者の場合には、顧客 ID を選択し、後者の場合には、購買発注 ID または他のトランザクション ID を選択します。  
  
4.  [**項目**] で、アソシエーションを検索する必要がある項目が含まれている列を選択します。  
  
     たとえば、マーケット バスケット モデルでは、製品フィールドを選択し、同時に購入されることの多い製品を分析します。 個別の製品が多すぎて効果的に相互に関連付けることができない場合は、製品カテゴリ フィールドまたは製品サブカテゴリ フィールドを選択できます。  
  
5.  [**しきい**値] では、モデルの出力を制御または影響を与える値を設定できます。  
  
    -   **最小のサポート。** 重要と見なす条件としてアイテムのグループの出現回数を指定します。 このアルゴリズムでは、この条件を満たしていないアイテムの組み合わせが無視されます。 たとえば、アイテムが全体で 10 回以上同時に出現するアイテムセットのみを表示することができます。  
  
    -   **ルールの最小確率**。 ルールを保存するのに必要な最小の確率値を指定します。 すべての組み合わせを見つけるためにデータ セット全体が分析され、確率が計算されます。 しきい値が低い場合は、緩い相関関係にあるアイテムのみが関連付けられます。 しきい値が高すぎると、サポートするデータが十分ではないために、いくつかのアソシエーションが除外される場合があります。  
  
     一般に、これらの値を変更すると、次のような効果があります。  
  
    -   サポートの値を小さくすると、検出される組み合わせの数が増加します。  
  
    -   最大のサポートを減らすと、頻繁に出現するためにほとんど意味を持たないアイテムが除外されます。  
  
    -   ルールの確率を小さくすると、データ セット全体のコンテキストで重要と見なされる組み合わせのしきい値が低くなります。  
  
     **ヒント:** サポートと確率の組み合わせを変えて、複数のマイニングモデルを作成することをお勧めします。 各モデルで使用した設定を追跡するには、Excel 用のデータマイニングクライアントで使用できる**ドキュメントモデル**ウィザードを使用し、[**詳細**レポート] オプションを使用します。 詳細については、「 [Excel 用データマイニングアドイン &#40;マイニングモデルを文書化する&#41;](documenting-mining-models-data-mining-add-ins-for-excel.md)」を参照してください。  
  
6.  必要に応じて、[**パラメーター** ] をクリックして、アルゴリズムパラメーターを変更し、マイニングモデルの動作をカスタマイズします。  
  
     [アルゴリズム パラメーター] ダイアログ ボックスには、ウィザードで設定したすべてのパラメーターと、MAXIMUM_SUPPORT などの使用頻度の低いいくつかのパラメーターが含まれています。 これらのパラメーターの使用方法の詳細については、「 [Microsoft アソシエーションアルゴリズムテクニカルリファレンス](data-mining/microsoft-association-algorithm-technical-reference.md)」を参照してください。  
  
7.  [**完了**] ページで、データセットとモデルの一意の名前を入力します。  
  
8.  [**オプション**] では、完了後にモデルを操作する方法を定義します。  
  
    -   [**参照**]。  モデルの準備ができると、ルール、アイテムセット、およびアソシエーションを示す依存関係ネットワーク グラフを表示するウィンドウが開きます。  
  
         アソシエーションモデルビューアーでデータを解釈する方法の詳細については、「[アソシエーションルールモデルの参照](browsing-an-association-rules-model.md)」を参照してください。  
  
    -   **ドリルスルーを有効に**します。 このチェック ボックスをオンにすると、モデルを通じて基になるデータにアクセスできます。  
  
         ドリルスルーは、特定のアイテムセットをクリックしてソース データを表示する場合などに便利です。  
  
    -   **一時的なモデルを使用**します。 モデルがサーバーに保存されないようにする場合は、このオプションを選択します。 一時的なモデルは、Excel の終了時に削除されます。  
  
9. このウィザードは、すべての可能な組み合わせを分析し、アイテムセットとルールを含むレポートを作成します。  
  
## <a name="more-about-association-models"></a>アソシエーション モデルの詳細  
 [!INCLUDE[msCoName](../includes/msconame-md.md)] アソシエーション ルール アルゴリズムは、トレーニング データを調べて、トランザクション内で一緒に出現するアイテムを検索します。 アイテムの各*グループは、アイテムセット*を構成します。 次に、アルゴリズムは各アイテムセットの出現回数をカウントし、すべてのトランザクション間での各アイテムセットの相対的な重要度を計算します。  
  
 アルゴリズムは、アイテムセットに関するこの情報を使用して、アソシエーションの予測や提案に使用できるルールを生成します。 たとえば、"ユーザーが Author 1 の本および Author 2 の本を購入した場合、Author 3 の本も購入する可能性がある" というルールを生成します。 それぞれの提案に対して、アソシエーションの強さに基づいて確率が割り当てられます。  
  
### <a name="requirements"></a>要件  
 関連付けウィザードを使用するには、[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] データベースに接続する必要があります。  
  
 ソース データをトランザクション テーブルとして編成する必要があります。 ソース データは、トランザクション識別子を含む列を 1 つ含む必要があります。 この列は、アイテムの各グループを識別します。 このトランザクション列は、2 番目のアイテム ID の列と 1 対他の関係にする必要があります。アイテム ID の列には、グループ内の個別のアイテムの名前または ID 番号が格納されています。  
  
 概念上の理解を簡単にするために、ショッピング カートの例について説明します。 ショッピング カートに ID が割り当てられている場合は、ショッピング カート ID がトランザクションの識別子として機能します。 ショッピング カート内の各アイテム (ジャガイモや牛乳など) は、そのトランザクションのメンバーです。 関連付けアルゴリズムは、トランザクション全体でアイテムを追跡して、1 つのトランザクションにジャガイモおよびミルクが出現する回数を判断するなどの作業を行うことができます。  
  
 ソース データは、トランザクション識別子列によって並べ替える必要があります。  
  
## <a name="see-also"></a>参照  
 [データマイニングモデルの作成](creating-a-data-mining-model.md)   
 [アソシエーションルールモデルの参照](browsing-an-association-rules-model.md)   
 [買い物かご分析 &#40;テーブル AnalysisTools for Excel&#41;](shopping-basket-analysis-table-analysistools-for-excel.md)   
 [依存関係ネットワークダイアグラムのチュートリアル &#40;データマイニングアドイン&#41;](dependency-network-diagram-walkthrough-data-mining-add-ins.md)  
  
  
