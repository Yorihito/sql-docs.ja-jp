---
title: What-if シナリオ (Excel 用のテーブル分析ツール) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- Table Analysis tools
- what if scenario
- scenario analysis
ms.assetid: 4df5a5c5-1983-4009-a7c5-cd340649fd2f
author: minewiskan
ms.author: owend
ms.openlocfilehash: ed1fe8447064bf224ea3f0e0a576d4e73fb07203
ms.sourcegitcommit: 9ee72c507ab447ac69014a7eea4e43523a0a3ec4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/17/2020
ms.locfileid: "84938113"
---
# <a name="what-if-scenario-table-analysis-tools-for-excel"></a>What-If シナリオ (Excel 用のテーブル分析ツール)
  ![テーブル分析ツールの [What If シナリオ] ボタン](media/tat-whatif.gif "テーブル分析ツールの [What If シナリオ] ボタン")

 **What-if**シナリオツールは、既存のデータのパターンを分析し、1つの列の変更が別の列の値に与える影響を評価できるようにします。

 たとえば、品目の値上げがその売上合計に与える影響を調べる場合などに使用します。

 このツールで作成される予測の数は、ユーザーが適宜選択できます。 初期分析の実行後に、テーブル内の全データを対象に変化を予測するか、テスト値を逐一入力するかを選択できます。

## <a name="using-the-what-if-scenario-tool"></a>What-If シナリオ ツールの使用

1.  Excel データ テーブルを開きます。

2.  [**シナリオ**] をクリックし、[ **what-if**] を選択します。

3.  [**シナリオ**] ボックスで、変更する値が含まれている列を選択し、変更を特定の値として指定するか、または現在の値に対する変更の割合 (増加または減少) として指定します。

4.  [**処理の対象**] ボックスで、効果を評価する列を指定します。

5.  必要に応じて、[**分析に使用する列の選択**] をクリックして、予測の作成に役立つ可能性のある列を選択します。 行の ID や名前など、パターンの検出に貢献しない列については、選択を解除することもできます。

6.  [**行またはテーブルの指定**] ボックスで、現在選択されている行に対してのみ、またはテーブル内の完全なデータセットの影響を評価するかどうかを選択します。

7.  **この行**を選択すると、ダイアログボックスに結果が表示されます。 このダイアログ ボックスを開いたまま、選択を変更して他のシナリオをテストできます。

8.  [**テーブル全体**] を選択すると、ダイアログボックスにステータスメッセージが表示され、元のデータテーブルに2つの新しい列が追加されます。 ワークシート内の完全な結果を表示するには、[**閉じる**] をクリックします。

### <a name="requirements"></a>要件
 このツールでは、数値または不連続値の予測をサポートする Microsoft ロジスティック回帰アルゴリズムが使用されます。 ただし、最適な結果を得るために、次のベスト プラクティスに従うことをお勧めします。

-   有用な情報を含む列を分析対象として選択します。

-   対象となる列が少なすぎると、結果を得ることが難しくなる場合があります。

-   [**値の指定**] オプションを使用する場合は、ボックスに値を入力するか、一覧から値を選択する必要があります。

-   [**パーセント**] オプションを使用する場合は、[増減の割合] で変更を設定します。 既定値は 120% (現在の値の 20% 増) です。

> [!NOTE]
>  値を設定しないと、エラーが発生することがあります。

## <a name="understanding-the-results-of-what-if-analysis"></a>What-If 分析の結果について
 **What-if**シナリオを作成すると、ツールによって次の3つの処理が実行されます。

-   テーブル内のデータに関する主要な要因を格納するデータ マイニング構造を作成する。

-   データに基づいて、ロジスティック回帰マイニング モデルを作成する。

-   指定された個々の値について予測クエリを作成する。

 **テーブル全体**を指定することにより、すべての予測を一度に出力できます。 この場合、元のデータ テーブルに 2 つの新しい列が作成されます。

 テーブルに追加された列には、それぞれ、変更に対する予測値と、その信頼度という 2 種類の情報が格納されます。 信頼度は、予測が正しいかどうかの確率のことです。

 変更する値をダイアログ ボックスに逐一入力し、予測を対話形式で確認することもできます。 これは、*単一予測クエリ*を作成することと同じです。 予測クエリの結果は、予測の可否、予測された値、および信頼度を伴って出力されます。 信頼度は、点線を含むバーとして表示されます。 点線が長いほど、結果の信頼度が高いことを意味します。

 たとえば、顧客の購入時期に顧客の年齢を増加させ、顧客の年齢を25に上げることによる影響を判断しようとしている場合、 **what-if**ツールはデータマイニングモデルにクエリを実行し、次の結果を返します。

 **Purchases Bicycle の What-If 分析で解決策が見つかりました。**

 **'Purchases Bicycle' = yes**

 **信頼度: 普通**

 この結果は、データ テーブルの既存の行に基づいて作成されています。つまり、特定の顧客について、他のすべての条件はそのままで、年齢だけを 25 歳に変更した場合、その顧客は自転車を購入する可能性が高いことを示しています。

 予測を元のデータ テーブルに出力すると、その予測の実用性を判断しやすくなります。

## <a name="related-tools"></a>関連ツール
 より高度なデータ マイニング機能を備えた別のアドインとして、Excel 用のデータ マイニング クライアントがあります。Excel 用のデータ マイニング クライアントには、行動を予測するデータ マイニング モデルを作成するためのウィザードが備わっています。 詳細については、「[データマイニングモデルの作成](creating-a-data-mining-model.md)」を参照してください。

 **What-if**シナリオツールで使用されるアルゴリズムの詳細については、SQL Server オンラインブックの「Microsoft ロジスティック回帰アルゴリズム」を参照してください。

## <a name="see-also"></a>参照
 [Excel 用テーブル分析ツール](table-analysis-tools-for-excel.md)


