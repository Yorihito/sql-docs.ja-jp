---
title: データ コレクション | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: supportability
ms.topic: conceptual
helpviewer_keywords:
- data collection [SQL Server]
ms.assetid: 0cc1f95c-5815-4d78-8868-a900be15e674
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 70a7b7c959283f934ed94f654293d1de2ef8cd9d
ms.sourcegitcommit: f71e523da72019de81a8bd5a0394a62f7f76ea20
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/17/2020
ms.locfileid: "84970504"
---
# <a name="data-collection"></a>データ収集
  データ コレクターは、さまざまなデータのセットを収集する [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] のコンポーネントです。 データ コレクションは、継続的に実行されるかユーザー定義のスケジュールに基づいて実行されます。 データ コレクターは、収集したデータを管理データ ウェアハウスというリレーショナル データベースに格納します。

## <a name="benefits-of-data-collector"></a>データ コレクターの利点
 データ コレクターは、 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] のデータ収集プラットフォームの主要なコンポーネントであり、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]によって提供されるツールです。 データ コレクターでは、中心となる 1 つのポイントでデータベース サーバーやアプリケーションのデータを収集できます。 この収集ポイントではさまざまなソースからデータを取得できます。SQL トレースとは異なり、パフォーマンス データに制限されません。

 データ コレクターでは、テスト環境や実稼働環境に合わせてデータ収集の範囲を調整できます。 また、データ コレクターはデータ ウェアハウスも使用します。データ ウェアハウスは、データにさまざまな保有期間を設定して収集したデータを管理できるようにするリレーショナル データベースです。

 データ コレクターは、データ収集の動的なチューニングをサポートし、その API を通じて拡張できます。 詳細については、「 [データ コレクターのプログラミング](../../database-engine/dev-guide/data-collector-programming.md)」を参照してください。

 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)]のデータ収集およびデータ管理の全体的な戦略にデータ コレクターがどのように組み込まれているかを次の図に示します。

 ![データ管理におけるデータ コレクターの役割](../../database-engine/media/datacollectorroleindatastrategy.gif "データ管理におけるデータ コレクターの役割")

## <a name="data-collector-concepts"></a>データ コレクターの概念
 データ コレクターは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] エージェントと [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]に統合されており、この 2 つを広範囲にわたって使用します。 したがって、データ コレクターを使用する前に、この 2 つの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] コンポーネントのそれぞれに関連するいくつかの概念を理解しておく必要があります。

 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]エージェントは、コレクション ジョブのスケジュールおよび実行のために使用されます。 次の概念を理解しておく必要があります。

-   ジョブ

-   ジョブ ステップ

-   ジョブ スケジュール

-   Subsystem

-   プロキシ アカウント

 詳細については、「[管理タスクの自動化 &#40;SQL Server エージェント&#41;](../../ssms/agent/sql-server-agent.md)」を参照してください。

 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] ([!INCLUDE[ssIS](../../includes/ssis-md.md)]) は、個々のデータ プロバイダーからデータを収集するパッケージを実行するために使用されます。 以下の [!INCLUDE[ssIS](../../includes/ssis-md.md)] ツールと概念を理解しておく必要があります。

-   [!INCLUDE[ssIS](../../includes/ssis-md.md)] パッケージ

-   [!INCLUDE[ssIS](../../includes/ssis-md.md)] パッケージ構成

 詳細については、「[Integration Services &#40;SSIS&#41; Packages](../../integration-services/integration-services-ssis-packages.md)」を参照してください。

## <a name="data-collector-terminology"></a>データ コレクターの用語
 [!INCLUDE[ssDE](../../includes/ssde-md.md)]データコレクションをサポートするのエディションで、のインスタンスをターゲットにし [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ます。 サポートされるエディションの詳細については、 [SQL Server 2014 の各エディションがサポートする機能](../../getting-started/features-supported-by-the-editions-of-sql-server-2014.md)」の「管理容易性」セクションを参照してください。

 *対象ルート* では、対象となる階層内のサブツリーを定義します。 *対象セット* は、対象ルートで定義されたサブツリーにフィルターを適用した結果の対象のグループです。 対象ルートはデータベース ( [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]のインスタンス) またはコンピューター インスタンスです。

 [ターゲット] 特定の特性と動作を持つターゲットの種類を入力します。 たとえば、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] インスタンスの対象は、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] データベースの対象とは異なる特性を持ちます。

 データプロバイダー対象の型に固有の既知のデータソース。コレクター型にデータを提供します。

 コレクター型 [!INCLUDE[ssIS](../../includes/ssis-md.md)] データを収集して管理データウェアハウスにアップロードするための実際のメカニズムを提供する、パッケージの論理ラッパー。

 コレクションアイテムコレクター型のインスタンス。 コレクション アイテムは、入力プロパティ セットと収集頻度に基づいて作成されます。

 コレクションコレクションアイテムのグループを設定します。 コレクション セットは、ユーザーがユーザー インターフェイスから操作できるデータ収集の単位です。

 コレクションモードデータを収集して格納する方法。 コレクション モードにはキャッシュと非キャッシュがあります。 キャッシュ モードは継続的なコレクションをサポートし、非キャッシュ モードは要求時コレクションまたはコレクションのスナップショットで使用されます。

 管理データウェアハウス収集されたデータを格納するために使用するリレーショナルデータベース。

 データ コレクター コンポーネント間の依存関係およびリレーションシップを次の図に示します。

 ![データ コレクターの機能依存](../../database-engine/media/dc-functional-dependencies.gif "データ コレクターの機能依存")

 図に示すように、データ プロバイダーはデータ コレクターの外部にあり、定義することによって対象との暗黙的なリレーションシップを持ちます。 データ プロバイダーは特定の対象 (たとえばリレーショナル エンジンなどの [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] サービス) に固有で、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]のシステム ビュー、パフォーマンス モニター カウンター、WMI プロバイダーなど、データ コレクターが使用できるデータを提供します。

 コレクター型は、対象の種類に固有であり、対象の種類に対するデータ プロバイダーの論理アソシエーションを基にしています。 コレクター型は、特定のデータ プロバイダーからデータを収集する方法を (スキーマ化されたパラメーターを使用して) 定義し、データ ストレージ スキーマを指定します。 データ プロバイダー スキーマとデータ ストレージ スキーマは、収集したデータを格納するために必要です。 また、コレクター型は、管理データ ウェアハウスの場所も示します。管理データ ウェアハウスは、データ収集を実行するコンピューターにも別のコンピューターにも配置できます。

 図に示すコレクション アイテムは、特定のコレクター型のインスタンスで、コレクター型の XML スキーマなどの入力パラメーターでパラメーター化されています。 すべてのコレクション アイテムは、同じ対象ルートまたは空の対象ルート上で操作する必要があります。 これにより、データ コレクターは、異なる対象ルートからではなく、オペレーティング システムまたは特定の対象ルートからコレクター型を結合できます。

 コレクション アイテムには、値のスナップショットを取得する頻度を決める、収集の頻度を定義します。 コレクション アイテムは、コレクション セットの構成要素ですが、単独では存在できません。

 コレクション セットは、サーバー インスタンス上に定義および配置され、互いに独立して実行できます。 各コレクション セットは、コレクション セットに含まれる全コレクター型の対象の種類に一致する対象に適用できます。 コレクション セットは [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] エージェント ジョブによって実行され、定義済みのスケジュールに従ってデータが管理データ ウェアハウスにアップロードされます。

 コレクション セット内の別々のインスタンスが収集したデータはすべて同じスケジュールに従って管理データ ウェアハウスにアップロードされます。 このスケジュールは、共有の [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] エージェント スケジュールとして定義され、複数のコレクション セットから使用できます。 コレクション セットは、単一のエンティティとしてオンまたはオフになります。コレクション アイテムは個別にオンまたはオフにできません。

 コレクション セットを作成または更新する際に、データの収集および管理データ ウェアハウスへのアップロード用のコレクション モードを構成できます。 スケジュールの種類は、コレクションの種類 (キャッシュまたは非キャッシュ) によって決まります。 コレクションがキャッシュ モードの場合、データ収集とアップロードはそれぞれ個別のジョブで実行されます。 コレクションは、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] エージェントの開始時に開始するスケジュールに基づいて実行され、コレクション アイテムで指定された頻度で実行されます。 アップロードは、ユーザーが指定したスケジュールに従って実行されます。

 非キャッシュ モードのコレクションの場合、データ収集とアップロードは、2 段階の単一ジョブで実行されます。 段階 1 が収集、段階 2 がアップロードです。 要求時コレクションにはスケジュールは必要ありません。

 コレクション セットが有効になったら、スケジュールに従うか、または要求に応じて、データ収集を開始できます。 データ収集を開始すると、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] エージェントがデータ コレクターのプロセスを生成し、生成されたプロセスはコレクション セットの [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] パッケージを順番に読み込みます。 コレクション型を表すコレクション アイテムは、指定した対象上の適切なデータ プロバイダーからデータを収集します。 収集のサイクルが終わると、このデータは管理データ ウェアハウスにアップロードされます。

## <a name="data-collector-tasks"></a>データ コレクターのタスク

|タスクの説明|トピック|
|----------------------|-----------|
|データ コレクションの有効化または無効化、コレクション セットの構成の変更、管理データ ウェアハウスのデータの表示など、データ コレクションのさまざまな側面を管理する方法について説明します。|[データ コレクションの管理](manage-data-collection.md)|
|レポートを使用して、システム容量の監視やシステム パフォーマンスのトラブルシューティングに役立つ情報を取得する方法について説明します。|[システム データ コレクション セット レポート](system-data-collection-set-reports.md)|
|管理データ ウェアハウスを使用して、データ コレクションの対象であるサーバーからデータを収集する方法について説明します。|[管理データ ウェアハウス (management data warehouse)](management-data-warehouse.md)|


