---
title: 時系列予測の作成 (中級者向けデータマイニングチュートリアル) |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: fb22cffa-ac99-4d34-ac4a-9c93068e33e8
author: minewiskan
ms.author: owend
manager: kfile
ms.openlocfilehash: ca1aa4022931c78f6139a8058c05adc707af5e77
ms.sourcegitcommit: 6fd8c1914de4c7ac24900fe388ecc7883c740077
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/26/2020
ms.locfileid: "63313887"
---
# <a name="creating-time-series-predictions-intermediate-data-mining-tutorial"></a>時系列予測の作成 (中級者向けデータ マイニング チュートリアル)
  このレッスンの前の作業では、時系列モデルを作成し、結果を検証しました。 既定では、[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] によって常に時系列モデルの 5 つの予測のセットが作成され、予測された値が予測グラフの一部として表示されます。 ただし、データ マイニング拡張機能 (DMX) の予測クエリを作成することによって、予測を作成することもできます。  
  
 この作業では、ビューアーに表示された予測と同じ予測を生成する予測クエリを作成します。 「基本的なデータ マイニング チュートリアル」のレッスンが完了し、予測クエリ ビルダーの使用方法について理解していることを前提とします。 ここでは、時系列モデルに固有のクエリを作成する方法を学習します。  
  
## <a name="creating-time-series-predictions"></a>時系列予測の作成  
 通常、予測クエリを作成するには、まず、マイニング モデルと入力テーブルを選択します。 ただし、時系列モデルでは、通常の予測では必要な追加の入力が必要ありません。 したがって、モデルにデータを追加したり、データを置き換えたりする場合以外は、予測を行うときに新しいデータ ソースを指定する必要はありません。  
  
 このレッスンでは、予測期間の値を指定する必要があります。 系列名を指定して、製品と地域の特定の組み合わせに対する予測を取得できます。  
  
#### <a name="to-select-a-model-and-input-table"></a>モデルと入力テーブルを選択するには  
  
1.  データマイニングデザイナーの [**マイニングモデル予測**] タブで、[**マイニングモデル**] ボックスの [**モデルの選択**] をクリックします。  
  
2.  **[マイニングモデルの選択**] ダイアログボックスで、予測構造を展開し、一覧から**予測**モデルを選択して、[ **OK]** をクリックします。  
  
3.  **[入力テーブルの選択**] ボックスは無視します。  
  
    > [!NOTE]  
    >  時系列モデルでは、クロス予測を実行する場合以外は、個別の入力を指定する必要はありません。  
  
4.  [**基**になる列] の [**マイニングモデル予測**] タブのグリッドで、最初の空白行のセルをクリックし、[**マイニングモデルの予測**] を選択します。  
  
5.  [**フィールド]** 列で [**モデル領域**] を選択します。  
  
     この操作により、予測クエリに系列の識別子が追加され、予測が適用されるモデルと地域の組み合わせが指定されます。  
  
6.  [**基**になる列] で次の空白行をクリックし、[**予測関数**] を選択します。  
  
7.  [**フィールド]** 列で、[ **PredictTimeSeries**] を選択します。  
  
    > [!NOTE]  
    >  `Predict`関数をタイムシリーズモデルと共に使用することもできます。 ただし、既定では、Predict 関数を使用すると、系列ごとに 1 つしか予測が作成されません。 したがって、複数の予測ステップを指定するには、 **PredictTimeSeries**関数を使用する必要があります。  
  
8.  [**マイニングモデル**] ペインで、[マイニングモデル] 列に [Amount] を選択し**ます。** [Amount] を、前に追加した**PredictTimeSeries**関数の [**条件と引数**] ボックスにドラッグします。  
  
9. [**条件と引数**] ボックスをクリックし、フィールド名の後にコンマを入力し、続けて「 **5**」と入力します。  
  
     [**条件と引数**] ボックスのテキストに、次のように表示されます。  
  
     `[Forecasting].[Amount],5`  
  
10. [**別名**] 列に「 `PredictAmount`」と入力します。  
  
11. [**ソース**] 列の次の空白行をクリックし、[**予測関数**] を再度選択します。  
  
12. [**フィールド]** 列で、[ **PredictTimeSeries**] を選択します。  
  
13. [**マイニングモデル**] ペインで、[Quantity] 列を選択し、2番目の**PredictTimeSeries**関数の [**条件と引数**] ボックスにドラッグします。  
  
14. [**条件と引数**] ボックスをクリックし、フィールド名の後にコンマを入力し、続けて「 **5**」と入力します。  
  
     [**条件と引数**] ボックスのテキストに、次のように表示されます。  
  
     `[Forecasting].[ Quantity],5`  
  
15. [**別名**] 列に「 `PredictQuantity`」と入力します。  
  
16. [**クエリ結果ビューに切り替え] を**クリックします。  
  
     クエリの結果が表形式で表示されます。  
  
 クエリ ビルダーで 3 種類の異なる結果を作成したことに注意してください。列の値を使用した結果が 1 つと、予測関数から予測値を取得した結果が 2 つです。 したがって、クエリの結果には 3 つの異なる列が含まれます。 最初の列には、製品と地域の組み合わせの一覧が格納されます。 2 番目と 3 番目の列には、それぞれ、予測結果の入れ子になったテーブルが格納されます。 入れ子になった各テーブルには、次の表のような時間ステップと予測された値が含まれます。  
  
 例の結果 (金額は小数点以下 2 桁に切り捨てられます):  
  
 **M200 ヨーロッパ PredictAmount**  
  
|$TIME|金額|  
|-----------|------------|  
|7/25/2008|99978.00|  
|8/25/2008|145575.07|  
|9/25/2008|116835.19|  
|10/25/2008|116537.38|  
|11/25/2008|107760.55|  
  
 **M200 ヨーロッパ PredictQuantity**  
  
|$TIME|Quantity|  
|-----------|--------------|  
|7/25/2008|52|  
|8/25/2008|67|  
|9/25/2008|58|  
|10/25/2008|57|  
|11/25/2008|54|  
  
 **M200 北米-PredictAmount**  
  
|$TIME|金額|  
|-----------|------------|  
|7/25/2008|348533.93|  
|8/25/2008|340097.98|  
|9/25/2008|257986.19|  
|10/25/2008|374658.24|  
|11/25/2008|379241.44|  
  
 **M200 北米-PredictQuantity**  
  
|$TIME|Quantity|  
|-----------|--------------|  
|7/25/2008|272|  
|8/25/2008|152|  
|9/25/2008|250|  
|10/25/2008|181|  
|11/25/2008|290|  
  
> [!WARNING]  
>  サンプル データベースで使用されている日付は、このリリース用に更新されています。 以前のバージョンのサンプル データを使用している場合は、異なる結果が表示されることがあります。  
  
## <a name="saving-the-prediction-results"></a>予測結果の保存  
 いくつかの方法で予測結果を使用することができます。 結果をフラット化し、結果ビューのデータをコピーして、Excel ワークシートなどのファイルに貼り付けることができます。  
  
 結果を保存するプロセスを簡単にするため、データ マイニング デザイナーではデータをデータ ソース ビューに保存する機能も提供されています。 結果をデータ ソース ビューに保存する機能は、[!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] だけで使用できます。 結果はフラット化された形式でのみ格納できます。  
  
#### <a name="to-flatten-the-results-in-the-results-pane"></a>結果ペインで結果をフラット化するには  
  
1.  [予測クエリビルダーで、[**クエリデザインビューに切り替え**] をクリックします。  
  
     ビューが切り替わり、DMX クエリ テキストを手動で編集できるようになります。  
  
2.  `FLATTENED` キーワードの後に、`SELECT` キーワードを入力します。 最終的なクエリ テキストは次のようになります。  
  
    ```  
    SELECT FLATTENED  
      [Forecasting].[Model Region],  
      (PredictTimeSeries([Forecasting].[Amount],5)) as [PredictAmount],  
      (PredictTimeSeries([Forecasting].[Quantity],5)) as [PredictQuantity]  
    FROM  
      [Forecasting]  
    ```  
  
3.  必要に応じて、次の例のように、結果を制限するための句を入力できます。  
  
    ```  
    SELECT FLATTENED  
      [Forecasting].[Model Region],  
      (PredictTimeSeries([Forecasting].[Amount],5)) as [PredictAmount],  
      (PredictTimeSeries([Forecasting].[Quantity],5)) as [PredictQuantity]  
    FROM  
      [Forecasting]  
    WHERE [Forecasting].[Model Region] = 'M200 North America'   
    OR [Forecasting].[Model Region] = 'M200 Europe'  
  
    ```  
  
4.  [**クエリ結果ビューに切り替え] を**クリックします。  
  
#### <a name="to-export-prediction-query-results"></a>予測クエリの結果をエクスポートするには  
  
1.  [**クエリ結果の保存**] をクリックします。  
  
2.  [**データマイニングのクエリ結果の保存**] ダイアログボックスの [**データソース**] で、[] を選択[!INCLUDE[ssSampleDBDWobject](../includes/sssampledbdwobject-md.md)]します。 データを別のリレーショナル データベースに保存する場合は、データ ソースを作成することもできます。  
  
3.  [**テーブル名**] 列に、「**テスト予測**」など、新しい一時テーブル名を入力します。  
  
4.  **[Save]** (保存) をクリックします。  
  
    > [!NOTE]  
    >  作成したテーブルを表示するには、データを保存したインスタンスのデータベース エンジンに対する接続を作成し、クエリを作成します。  
  
## <a name="conclusion"></a>まとめ  
 基本的な時系列モデルを作成し、予測を解釈し、予測を作成する方法について学習しました。  
  
 このチュートリアルの残りのタスクは省略可能であり、高度な時系列予測について説明します。 さらにチュートリアルを続けると、モデルに新しいデータを追加し、拡張系列で予測を作成する方法について学習できます。 また、モデルの傾向を使用し、データを新しい系列に置き換えることで、クロス予測を実行する方法についても学習します。  
  
## <a name="next-lesson"></a>次のレッスン  
 [高度な時系列予測 &#40;中級者向けデータマイニングチュートリアル&#41;](../../2014/tutorials/advanced-time-series-predictions-intermediate-data-mining-tutorial.md)  
  
## <a name="see-also"></a>参照  
 [タイム シリーズ モデルのクエリ例](../../2014/analysis-services/data-mining/time-series-model-query-examples.md)  
  
  
