---
title: 'タスク 4 (省略可能): 新しいデータセットを結合、照合、およびパブリッシュする |Microsoft Docs'
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: data-quality-services
ms.topic: conceptual
ms.assetid: 13a13f03-b307-4555-8e33-6d98c459d994
author: lrtoyou1223
ms.author: lle
ms.openlocfilehash: d2f67c88be66be069a48d008ba6889a81dfda8ae
ms.sourcegitcommit: 57f1d15c67113bbadd40861b886d6929aacd3467
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/18/2020
ms.locfileid: "85061108"
---
# <a name="task-4-optional-combining-matching-and-publishing-new-set-of-data"></a>タスク 4 (オプション): 新しいデータ セットを結合、照合、およびパブリッシュする
  後で、MDS リポジトリにさらにデータを追加する場合があります。 データを追加する前に、新しいデータを MDS で既に管理されているデータと比較して、重複していないデータや不正確なデータを追加していないことを確認すると便利です。 Excel 用マスター データ サービス アドインを使用すると、データを MDS にパブリッシュする前に、2 つのワークシートのデータを結合し、データを比較することで重複を識別して削除できます。 MDS Excel アドインの照合機能は、データの一致を識別するための DQS 照合機能を使用します。 ここでは、MDS にパブリッシュする前に、2 つのワークシートのデータを 1 つに結合し、重複を識別して削除するための照合作業を行います。 詳細については、「Excel 用 MDS アドインと[データの結合](https://msdn.microsoft.com/library/hh548680.aspx)」トピックの「[データ品質照合](https://msdn.microsoft.com/library/hh548681.aspx)」を参照してください。  
  
1.  **Excel**の新しいインスタンスを起動します。 [**スタート**] をクリックし、[**実行**] をポイントして「 **Excel**」と入力し、[ **OK]** をクリックします。  
  
2.  メニューバーの [**マスターデータ**] をクリックして、[**マスターデータ**] タブに切り替えます。  
  
3.  [**接続と読み込み**] グループのリボンで [**接続**] をクリックして、 **MDS サーバー**に接続します。 この接続は、このレッスンの前の手順で構成しました。  
  
     ![Excel - [マスター データ] タブの [エクスプローラーの表示] ボタン](../../2014/tutorials/media/et-combinematchandpublishnewsod-01.jpg "Excel - [マスター データ] タブの [エクスプローラーの表示] ボタン")  
  
4.  右側に [**マスターデータエクスプローラー** ] ウィンドウが表示されます。 マスターデータエクスプローラーが表示されない場合は、リボンの [**エクスプローラーの表示**] ボタンをクリックします。  
  
5.  [**マスターデータエクスプローラー** ] ウィンドウで、**モデル**のドロップダウンリストから [**仕入先**] を選択します。 モデルには**Supplier**というエンティティが1つあることがわかります。  
  
     ![Excel - [マスター データ エクスプローラー] ウィンドウ](../../2014/tutorials/media/et-combinematchandpublishnewsod-02.jpg "Excel - [マスター データ エクスプローラー] ウィンドウ")  
  
6.  [エンティティ] ボックスの一覧の [ **Supplier** ] をダブルクリックして、エンティティメンバーを Excel ワークシートに読み込みます。  
  
7.  下部にある [ **sheet2** ] をクリックして、[ **sheet2** ] タブに切り替えます。[ **Sheet2**] が表示されない場合は、新しいワークシートを追加します。  
  
8.  **Suppliers.xls**ファイル (チュートリアルファイルに含まれている元の入力ファイル) を開き、連結の**eandクレンジング**ワークシートのすべての (3 行) を**Sheet2**にコピーします。  
  
9. **MDS**に接続されている、(クレンジングされた**仕入先リスト**Excel ではなく) **Microsoft Excel ブック**の**Supplier**シートに戻ります。  
  
10. メニューバーの [**マスターデータ**] をクリックします。  
  
11. リボンの [**データの結合**] をクリックします。 [**データの結合**] ダイアログボックスが表示されます。  
  
12. [**データの結合**] ダイアログボックスで、次の図のように [**範囲を MDS データと結合する範囲**] ボックスの横にあるボタンをクリックします。  
  
     ![Excel - [データの結合] ダイアログ ボックス](../../2014/tutorials/media/et-combinematchandpublishnewsod-03.jpg "Excel - [データの結合] ダイアログ ボックス")  
  
13. これで、ダイアログ ボックスは圧縮表示されます。 次に、[ **sheet2** ] をクリックして、4つの行 (ヘッダー行を含む) を持つ新しい仕入先データを含む [ **sheet2** ] タブに切り替えます。  
  
14. **Sheet2**で、**ヘッダー行を含むすべての行**を選択します (既に選択されているように見える場合でも)。 **MDS データと結合する範囲**が自動的に更新されていることを確認します。  
  
     ![Excel - [データの結合] ダイアログ ボックス - 最小化](../../2014/tutorials/media/et-combinematchandpublishnewsod-04.jpg "Excel - [データの結合] ダイアログ ボックス - 最小化")  
  
15. [**データの結合**] ダイアログボックスを閉じずに、[**仕入先**] タブに戻ります。  
  
16. **テキストボックス**の横にある**ボタン**をクリックします。 これで、ダイアログ ボックスは展開表示されます。 **Supplier** MDS**エンティティ**の列間のすべてのマッピングが**Excel**列に自動的に設定されていることがわかります。  
  
     ![Excel-データが入力された [データの結合] ダイアログボックス](../../2014/tutorials/media/et-combinematchandpublishnewsod-05.jpg "Excel-データが入力された [データの結合] ダイアログボックス")  
  
17. **Code**エンティティ列がワークシートの [**仕入**先] 列にマップされ、[**郵便**番号] エンティティ列がワークシートの [**郵便**番号] 列にマップされていることを確認します。  
  
18. [**データの結合**] ダイアログボックスで、[**結合**] をクリックします。  
  
19. 3 つのデータ行がワークシートの下部に追加され、色分けされていることを確認してください。  
  
     ![Excel - 結合後の新しい要素](../../2014/tutorials/media/et-combinematchandpublishnewsod-06.jpg "Excel - 結合後の新しい要素")  
  
20. リボンの [**数値演算データ**] をクリックして、重複を識別します。 この機能は、DQS の照合機能を使用します。  
  
21. [**データの照合**] ダイアログボックスで、[ **DQS ナレッジベース**の**サプライヤー** ] を選択します。  
  
     ![Excel - [データの照合] ダイアログ ボックス](../../2014/tutorials/media/et-combinematchandpublishnewsod-07.jpg "Excel - [データの照合] ダイアログ ボックス")  
  
22. 次の表のようにワークシートの列をドメインにマップします。  
  
    |ワークシートの列|Domain|  
    |----------------------|------------|  
    |Code (MDS の Supplier エンティティ用にコードとしてアップロードした仕入先の ID)|Supplier ID|  
    |Name (Supplier エンティティの名前として MDS にアップロードした仕入先の名前)|Supplier Name|  
    |ContactEmailAddress|ContactEmail|  
  
23. **コード**列マッピングの**前提条件**を選択します。  
  
24. 図に示されているように、**仕入**先の名前の**重み**として「 **70%** 」を、**連絡先の電子メール**の**重み**として「 **30%** 」と入力します。  
  
25. **[OK]** をクリックします。  
  
26. 照合プロセスでは、**コード: S1**を使用して、業者の重複を識別する必要があります。  
  
     ![Excel - 照合結果](../../2014/tutorials/media/et-combinematchandpublishnewsod-08.jpg "Excel - 照合結果")  
  
27. 重複する**行 (オレンジ色)** を選択して右クリックし、[**削除**] をクリックして行を削除します。  
  
28. 不要になったため、 **CLUSTER_ID**列を削除します。  
  
29. [**発行**] をクリックして、S66 および**S57**という**コード**を使用して、他の2つの新しいレコードを MDS に発行します。  
  
30. [**パブリッシュと注釈**設定] ダイアログボックスで、**注釈**を追加し、[**発行**] をクリックします。  
  
31. **マスターデータマネージャー Web アプリケーション**に切り替えます。  
  
32. [ホーム] ページで、[**仕入先**] が**モデル**に対して選択されていることを確認し、[**エクスプローラー**] をクリックします。 **エクスプローラー**が既に開いている場合は、インターネットブラウザーを最新の状態に更新します。  
  
33. **コード**によってリストを**並べ替え**、コードとして**S57**と**S66**のレコードを検索します。 また、ツールバーの [**フィルター** ] ボタンを使用して、一覧内の特定のレコードを検索することもできます。  
  
34. 次に、ファイルを保存せずに**Book1-Microsoft Excel**ウィンドウを閉じます。  
  
## <a name="next-step"></a>次の手順  
 [タスク 5: Excel からドメイン ベースの属性を作成する](../../2014/tutorials/task-5-creating-a-domain-based-attribute-from-excel.md)  
  
  
