---
title: テキスト形式の定義 (テキストファイルドライバー) |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- text format [ODBC]
- text file driver [ODBC], text format
ms.assetid: 3af46dad-52cc-4d5c-a27e-6315d65a74e6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 29dc46525f3c81e5abffe5076988716a01df06df
ms.sourcegitcommit: e042272a38fb646df05152c676e5cbeae3f9cd13
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/27/2020
ms.locfileid: "81307663"
---
# <a name="defining-text-format-text-file-driver"></a>テキスト形式の定義 (テキスト ファイル ドライバー)
テキストドライバーが使用されている場合は、[**テキスト形式の定義**] ダイアログボックスを使用して、選択したファイル内の列の形式を定義できます。 このダイアログボックスでは、各データテーブルのスキーマを指定できます。 この情報は、データソースディレクトリ内の schema.ini ファイルに書き込まれます。 テキストデータソースディレクトリごとに個別の schema.ini ファイルが作成されます。  
  
> [!NOTE]  
>  すべての新しいテキストデータテーブルには、同じ既定のファイル形式が適用されます。 CREATE TABLE ステートメントによって作成されるすべてのファイルは、同じ既定の形式の値を継承します。これらの値は、[ \<**テキスト形式の定義**] ダイアログボックスで [ファイル形式] の値を選択し、[**テーブル**] の一覧で既定> 選択されています。 テキストドライバーは、このダイアログボックスで定義されている形式に一致するように既存のテキストファイルの形式を変更しませんが、テキストファイルからデータを取得しようとしたときなど、形式を使用するとエラーが返されます。  
  
 [**テキスト形式の定義**] ダイアログボックスでは、次のオプションを使用できます。  
  
|オプション|情報|  
|------------|-----------------|  
|**追加**|ダイアログボックスから [**データ型**]、[**名前**]、および [**幅**] の値を使用して列を追加します。該当する場合は、schema.ini の日付の区切り記号の値を使用します。|  
|**文字**|**ANSI**または**OEM**。 OEM は、ANSI 以外の文字セットを指定します。 [**テーブル**] ボックスの一覧で選択した項目の形式が、このダイアログボックスで以前に定義されていない場合は、既定で [OEM] になります。|  
|**列名のヘッダー**|選択したテーブルの最初の行の列を列名として使用するかどうかを示します。 **TRUE**または**FALSE**のいずれかです。 [**テーブル**] ボックスの一覧で選択した項目の形式が、このダイアログボックスで以前に定義されていない場合、既定値は FALSE になります。|  
|**[列]**|選択したテーブルの各列の列名が一覧表示されます。 列の順序は、テーブル内の列の順序を反映しています。 [**テーブル**] ボックスの一覧でファイルが選択されている場合は、この一覧が有効になります。|  
|**[データ型]**|BIT、BYTE、CHAR、CURRENCY、DATE、FLOAT、INTEGER、LONGCHAR、SHORT、または SINGLE を指定できます。 日付データ型は、"dd-mmm-yy"、"mm-dd-yy"、"mmm-dd-yy"、"yyyy-mm-dd"、または "yyyy-mm-dd" の形式にすることができます。 "mm" は月の数字を表します。"mmm" は月の文字を表します。|  
|**区切り記号**|列を区切るために使用するカスタムの区切り文字を指定します。 **カスタムの区切り**形式が選択されている場合に有効になります。 区切り記号の長さは1文字のみで、二重引用符 (") を区切り文字として使用することはできません。 (区切り記号は16進数または10進数形式では指定できません)。|  
|**形式**|区切り記号または固定長。 区切られた場合は、使用される区切り記号の種類 (コンマ (CSV)、タブ、または特殊文字 (カスタム)) を示します。 [**テーブル**] ボックスの一覧で選択した項目の形式が、このダイアログボックスで以前に定義されていない場合、この値は既定で [ **CSV** ] になります。<br /><br /> **Format**が固定長で、**列名ヘッダー**が TRUE の場合、最初の行はコンマで区切る必要があります。|  
|**思い**|では、選択したテーブル内の列の列のデータ型、名前、および幅の値が自動的に生成されます。これは、[**書式**] ボックスの選択に従ってテーブルの内容をスキャンすることによって行われます。 テーブル形式が区切られている場合に有効になります。 [**列**] ボックスの一覧で以前に定義した列はすべてクリアされ、新しいエントリに置き換えられます。 **列名ヘッダー**が選択されていない場合、列名は自動的に "F1"、"F2" などとして生成されます。 [**データ型**] ボックスには既定値が表示されません。<br /><br /> この機能は、64513バイト未満の列に対してのみ機能します。|  
|**変更**|[**データ型**]、[**名前**]、および [**幅**] の値を使用して、選択した列を変更します。|  
|**名前**|選択した列の名前を表示します。 既存の列または新しい列に新しい列名を指定するために使用できます。<br /><br /> **列名ヘッダー**が TRUE の場合、表示される列名は無視されます。|  
|**Remove**|選択した列を削除します。|  
|**スキャンする行**|既存のデータに基づいて列と列のデータ型を設定するときに、セットアップまたはドライバーがスキャンする行の数。<br /><br /> スキャンする行の数には、1 ~ 32767 の数値を入力できます。 [**テーブル**] ボックスの一覧で選択した項目の形式が、このダイアログボックスで以前に定義されていない場合、この値は既定で25になります。 (制限外の数値はエラーを返します)。|  
|**テーブル**|[**テキスト設定**] ダイアログボックスで選択したディレクトリにある、指定した拡張機能の一覧に一致するすべてのファイルの一覧が表示されます。<br /><br /> [ \<既定の>] が選択されていて、次のいずれかに該当する場合は、 **Tables**グループ内のテーブル属性の値が schema.ini に書き込まれます (schema.ini 内のその他のエントリは操作されません)。<br /><br /> -指定されたディレクトリには schema.ini がありません。<br />-Schema.ini ファイルは存在しますが、ディレクトリには、(指定された拡張子を持つ) テキストファイルの1つのセクションがありません。<br />-Schema.ini にはテキストファイルのセクションが存在しますが、本文は空です。<br /><br /> [ \<既定の>] を選択した場合、[**列**] グループは無効になります。|  
|**Width**|列の幅は、CHAR 型または LONGCHAR 型の列に対して変更できます。 [**テーブル**] ボックスの一覧で選択した項目の形式が、このダイアログボックスで以前に定義されていない場合、幅の既定値は1です。<br /><br /> その他のデータ型の場合、width コントロールは無効になり、値は表示されません。|
